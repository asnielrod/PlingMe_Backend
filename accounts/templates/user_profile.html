{% extends 'base.html' %}
{% load static %}

{% block content %}
<body>
  <!-- loader starts-->
  <div class="loader-wrapper">
    <div class="theme-loader">
      <div class="loader-p"></div>
    </div>
  </div>
  <!-- loader ends-->
  <!-- tap on top starts-->
  <div class="tap-top"><i data-feather="chevrons-up"></i></div>
  <!-- tap on tap ends-->
  <!-- page-wrapper Start-->
  <div class="page-wrapper compact-wrapper" id="pageWrapper">
    <!-- Page Header Start-->
    {% include 'includes/navbar.html' %}
    <!-- Page Header Ends -->
    <!-- Page Body Start-->
    <div class="page-body-wrapper">
      <!-- Page Sidebar Start-->
      {% include 'includes/sidebar.html' %}
      <!-- Page Sidebar Ends-->
      <div class="page-body">
        <div class="container-fluid">
          <div class="page-title">
            <div class="row">
              <div class="col-xl-4 col-sm-7 box-col-3">
                <h3>Edit Profile</h3>
              </div>
              <div class="col-5 d-none d-xl-block"></div>
              <div class="col-xl-3 col-sm-5 box-col-4">
                <ol class="breadcrumb">
                  <li class="breadcrumb-item">
                    <a href="index.html">
                      <svg class="stroke-icon">
                        <use href="{% static 'assets/svg/icon-sprite.svg' %}#stroke-home"></use>
                      </svg>
                    </a>
                  </li>
                  <li class="breadcrumb-item">Users</li>
                  <li class="breadcrumb-item active">Edit Profile</li>
                </ol>
              </div>
            </div>
          </div>
        </div>
        <!-- Container-fluid starts-->
        <form method="POST" enctype="multipart/form-data">
          {% csrf_token %}
          <div class="container-fluid">
            <div class="edit-profile">
              <div class="row">
                <!-- Sección izquierda: Avatar y Bio -->
                <div class="col-xl-4">
                  <div class="card">
                    <div class="card-header pb-0">
                      <h4 class="card-title mb-0">My Profile</h4>
                      <div class="card-options">
                        <a class="card-options-collapse" href="#" data-bs-toggle="card-collapse">
                          <i class="fe fe-chevron-up"></i>
                        </a>
                        <a class="card-options-remove" href="#" data-bs-toggle="card-remove">
                          <i class="fe fe-x"></i>
                        </a>
                      </div>
                    </div>
                    <div class="card-body">
                      <div class="row mb-2">
                        <div class="profile-title">
                          <div class="d-flex">
                            {% if request.user.avatar %}
                              <img class="img-70 rounded-circle" style="width: 70px; height: 70px; object-fit: cover;" src="{{ request.user.avatar.url }}" alt="Avatar">
                            {% else %}
                              <img class="img-70 rounded-circle" style="width: 70px; height: 70px; object-fit: cover;" src="{% static 'assets/images/user/7.jpg' %}" alt="Avatar">
                            {% endif %}
                            <div class="flex-grow-1 ms-3">
                              <h3 class="mb-1 f-w-600">{{ request.user.first_name }} {{ request.user.last_name }}</h3>
                              <p>{{ request.user.get_role_display }}</p>
                            </div>
                          </div>
                        </div>
                      </div>
                      <div class="mb-3">
                        <label class="form-label">Avatar</label>
                        {{ form.avatar }}
                      </div>
                      <div class="mb-3">
                        <label class="form-label">Bio</label>
                        {{ form.bio }}
                      </div>
                      <!-- Botón para guardar avatar y bio -->
                      <div class="form-footer text-end">
                        <button class="btn btn-primary" type="submit" name="action" value="avatar">Update Avatar &amp; Bio</button>
                      </div>
                    </div>
                  </div>
                </div>
                <!-- Sección derecha: Otros datos del usuario -->
                <div class="col-xl-8">
                  <div class="card">
                    <div class="card-header pb-0">
                      <h4 class="card-title mb-0">Edit Profile</h4>
                    </div>
                    <div class="card-body">
                      <div class="row">
                        <div class="col-md-6">
                          <label class="form-label">First Name</label>
                          {{ form.first_name }}
                        </div>
                        <div class="col-md-6">
                          <label class="form-label">Last Name</label>
                          {{ form.last_name }}
                        </div>
                        <div class="col-md-6">
                          <label class="form-label">Email (read-only)</label>
                          {{ form.email }}
                        </div>
                        <div class="col-md-6">
                          <label class="form-label">Language</label>
                          {{ form.language }}
                        </div>
                      </div>
                    </div>
                    <!-- Botón para guardar los demás datos -->
                    <div class="card-footer text-end">
                      <button class="btn btn-primary" type="submit" name="action" value="profile">Update Profile</button>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </form>
        <!-- Container-fluid Ends-->
      </div>
      <!-- footer start-->
      {% include 'includes/footer.html' %}
      <!-- footer end-->
    </div>
  </div>
</body>
</html>
{% endblock %}
